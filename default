proxy_cache_path /data/nginx/cache keys_zone=frontend:10m;

server {
        listen 443 ssl http2;
        server_name reazon.ru;

        ssl_certificate /etc/letsencrypt/live/reazon.ru/fullchain.pem; # managed by Certbot
        ssl_certificate_key /etc/letsencrypt/live/reazon.ru/privkey.pem; # managed by Certbot
        include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
        ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot

        return 301 https://www.reazon.ru$request_uri;
}

server {
        listen 80 http2;
        server_name www.reazon.ru reazon.ru;

        location / {
                return 301 https://www.reazon.ru$request_uri;
        }
}

server {
        listen 443 ssl http2; # managed by Certbot
        ssl_certificate /etc/letsencrypt/live/www.reazon.ru/fullchain.pem; # managed by Certbot
        ssl_certificate_key /etc/letsencrypt/live/www.reazon.ru/privkey.pem; # managed by Certbot
        include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
        ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot

        server_name www.reazon.ru;

        gzip            on;
        gzip_vary       on;
        gzip_proxied    any;
        gzip_types      text/plain text/css text/javascript text/js text/xml font/woff application/json application/javascript application/manifest+json image/webp image/svg+xml;
        gzip_min_length 256;

        # error_page 404 /home/ubuntu/front-next/dist/index.html;

        # root /home/ubuntu/front-next/dist;

        location / {
                # alias /home/ubuntu/front-next/dist;
                root /home/ubuntu/front-next/dist;
                return 301 https://www.reazon.ru
                # try_files $uri $uri/ /index.html =404;
                # try_files $uri $uri/ /index.html;

                # index index.html;

                # etag on;
                # expires max;
                # add_header Cache-Control public;

                # location = /index.html {
                #         expires 0;
                #         add_header Cache-Control "no-cache, public, must-revalidate, proxy-revalidate";
                # }
        }

        # location = /index.html {
        #         expires 30s;
        # }

        location /api/v1/ {
                proxy_pass http://89.208.198.137:8080/api/v1/;
        }
}
